<title>
A Hidden Markov Model method, capable of predicting and discriminating beta-barrel outer membrane proteins.
</title>

<text>

<sections.0>
Background
ntegral membrane proteins are divided into two distinct structural classes, the ±-helical membrane proteins and the ²-barrel membrane proteins. he former class is the more abundant and well studied, since proteins of that type are located mostly in the cell membranes of both prokaryotic and eukaryotic organisms, performing a variety of biologically important functions. roteins of that class have their membrane spanning regions forming ±-helices, which consist mainly of hydrophobic residues [1].  variety of algorithms and computational techniques have been proposed for the prediction of the transmembrane segments of ±-helical membrane proteins, with high accuracy and precision. he members of the latter class (²-barrel membrane proteins) are located in the outer membrane of gram-negative bacteria, and presumably in the outer membrane of chloroplasts and mitochondria. he members of that class are having their membrane spanning segments formed by antiparallel ²-strands, creating a channel in a form of a barrel that spans the outer membrane [2]. he first known members of that class were found to be the bacterial trimeric porins, forming water-filled channels that mediate the passive transport of ions and small molecules through the outer membrane [2]. uring the last few years, more ²-barrel proteins were found in the bacterial outer membrane, and a number of structures have been solved in atomic resolution [2]. hese proteins perform a wide variety of functions such as active ion transport, passive nutrient uptake, membrane anchoring, adhesion, and catalytic activity.  large number of pathogens are actually bacteria belonging to the gram negative bacteria class. onsidering additionally the important biological functions in which outer membrane proteins are involved in, it is not a surprise that those proteins attract an increased medical interest. his is confirmed by the continuously increasing number of completely sequenced genomes of gram-negative bacteria deposited in the public databases. n the other hand, the extensive study of the structure of transmembrane ²-barrel proteins, could reveal special aspects of the process of protein folding, and give us useful insights on protein structure and function. or the reasons mentioned above, there is clearly a need to develop computational tools for predicting the membrane spanning strands of those proteins, and also discriminating them from water-soluble proteins when searching entire genomes.
n contrast to the ±-helical membrane proteins, whose membrane spanning segments can be identified by statistical methods, neural networks, or idden arkov odels with high accuracy, this task is more difficult in the case of the ²-barrel membrane proteins of the outer membrane. his is due to the lack of a clear pattern in their membrane spanning strands, such as the stretch of 15β€“30 consecutive hydrophobic residues or the ositive nside rule, which occur in the ±-helical proteins. urthermore, discrimination of transmembrane strands from other ²-strands, forming ²-barrel structures in water-soluble proteins, is even more difficult. he reason for that is the fact that water-soluble proteins that form ²-barrel structures, share (up to a certain degree) common features with the transmembrane strands of the bacterial outer membrane proteins, such as amphipathicity.
 few approaches have been made, in the direction of predicting the transmembrane strands of outer membrane proteins and/or identifying those proteins when searching large data sets; they are based on study of the physicochemical properties of the ²-strands, such as hydrophobicity and amphipathicity [3], statistical analyses based on the amino acid composition of the known structures [4], or machine learning techniques like neural network predictors [5,6], and idden arkov odels [4,7,8]. ecently, a method based on a sequence profile-based  [8], requiring as input evolutionary information derived from multiple alignments, achieved the highest accuracy.
n this work we developed a idden arkov odel method based solely on the amino acid sequence, without the requirement of evolutionary information. he model is cyclic, and captures the structural characteristics of the transmembrane ²-strands of the outer membrane proteins. or training and evaluating the model, we compiled a non-redundant dataset of 14 outer membrane proteins with structure known at atomic resolution (able 1, see aterials and methods section), and tested it with a jacknife procedure. he model is also used for discriminating outer membrane proteins, in large-scale genome analyses.Background
Integral membrane proteins are divided into two distinct structural classes, the Ξ±-helical membrane proteins and the Ξ²-barrel membrane proteins. The former class is the more abundant and well studied, since proteins of that type are located mostly in the cell membranes of both prokaryotic and eukaryotic organisms, performing a variety of biologically important functions. Proteins of that class have their membrane spanning regions forming Ξ±-helices, which consist mainly of hydrophobic residues [1]. A variety of algorithms and computational techniques have been proposed for the prediction of the transmembrane segments of Ξ±-helical membrane proteins, with high accuracy and precision. The members of the latter class (Ξ²-barrel membrane proteins) are located in the outer membrane of gram-negative bacteria, and presumably in the outer membrane of chloroplasts and mitochondria. The members of that class are having their membrane spanning segments formed by antiparallel Ξ²-strands, creating a channel in a form of a barrel that spans the outer membrane [2]. The first known members of that class were found to be the bacterial trimeric porins, forming water-filled channels that mediate the passive transport of ions and small molecules through the outer membrane [2]. During the last few years, more Ξ²-barrel proteins were found in the bacterial outer membrane, and a number of structures have been solved in atomic resolution [2]. These proteins perform a wide variety of functions such as active ion transport, passive nutrient uptake, membrane anchoring, adhesion, and catalytic activity. A large number of pathogens are actually bacteria belonging to the gram negative bacteria class. Considering additionally the important biological functions in which outer membrane proteins are involved in, it is not a surprise that those proteins attract an increased medical interest. This is confirmed by the continuously increasing number of completely sequenced genomes of gram-negative bacteria deposited in the public databases. On the other hand, the extensive study of the structure of transmembrane Ξ²-barrel proteins, could reveal special aspects of the process of protein folding, and give us useful insights on protein structure and function. For the reasons mentioned above, there is clearly a need to develop computational tools for predicting the membrane spanning strands of those proteins, and also discriminating them from water-soluble proteins when searching entire genomes.
In contrast to the Ξ±-helical membrane proteins, whose membrane spanning segments can be identified by statistical methods, neural networks, or Hidden Markov Models with high accuracy, this task is more difficult in the case of the Ξ²-barrel membrane proteins of the outer membrane. This is due to the lack of a clear pattern in their membrane spanning strands, such as the stretch of 15β€“30 consecutive hydrophobic residues or the Positive Inside rule, which occur in the Ξ±-helical proteins. Furthermore, discrimination of transmembrane strands from other Ξ²-strands, forming Ξ²-barrel structures in water-soluble proteins, is even more difficult. The reason for that is the fact that water-soluble proteins that form Ξ²-barrel structures, share (up to a certain degree) common features with the transmembrane strands of the bacterial outer membrane proteins, such as amphipathicity.
A few approaches have been made, in the direction of predicting the transmembrane strands of outer membrane proteins and/or identifying those proteins when searching large data sets; they are based on study of the physicochemical properties of the Ξ²-strands, such as hydrophobicity and amphipathicity [3], statistical analyses based on the amino acid composition of the known structures [4], or machine learning techniques like neural network predictors [5,6], and Hidden Markov Models [4,7,8]. Recently, a method based on a sequence profile-based HMM [8], requiring as input evolutionary information derived from multiple alignments, achieved the highest accuracy.
In this work we developed a Hidden Markov Model method based solely on the amino acid sequence, without the requirement of evolutionary information. The model is cyclic, and captures the structural characteristics of the transmembrane Ξ²-strands of the outer membrane proteins. For training and evaluating the model, we compiled a non-redundant dataset of 14 outer membrane proteins with structure known at atomic resolution (Table 1, see Materials and methods section), and tested it with a jacknife procedure. The model is also used for discriminating outer membrane proteins, in large-scale genome analyses.
</sections.0>

<sections.1>
Results and discussion
he results obtained from the model are presented in additional file 1 and able 2 (for a definition of the transmembrane, , segments, see the aterials and methods section). able 2 shows the results obtained comparing the predicted strands and topologies with the  annotation and also those comparing with the manual annotation used for training (see aterials and methods). he model correctly predicts the location of 96.3% of the transmembrane strands (206 out of 214). wo (2) additional strands were predicted correctly but slightly misplaced from their observed positions. hese misplaced strands, which belong to the proteins with  codes 1 and 2, were the only strands that have been falsely predicted (false positives). he total number of correctly predicted topologies (correct prediction of ²-strands and orientation of the loops) is 10 and, when counting the misplaced strands, 11 out of 14 proteins in the training set. hen the comparison against the manual annotation used for training was performed, it was noted that there is one additional strand (the second  strand of 178), which is predicted slightly misplaced. he model has also been tested with the well-known jacknife procedure. he jacknife procedure consists of removing a protein from the training set, training the model with the remaining proteins and performing the test on the protein removed. his process is tandemly repeated for all proteins in the training set, and the final prediction accuracy summarizes the outcome of all independent tests. hus, this procedure is regarded as most appropriate for the assessment of a prediction method based on independent training and test data.
he result of the jacknife test concerning the correctly predicted  strands was 204 out of 214 (95.3%), with 12 over-predicted strands. he overall number of correctly predicted topologies was 9 out of 14. hen counting the predicted misplaced strands, the number of correctly predicted topologies raises to 10 out of 14. nce again when comparing against the manual annotation, the second  strand of 178, is predicted slightly misplaced.
he per-residue accuracies and correlation coefficients (see aterials and methods) for both the self-consistency and jacknife tests are listed also in able 2, with respect to either the  annotation or the manual annotation used for training. pparently, the significantly lower percentages reported in the case of comparison with the  annotation, is a clear consequence of the fact that the strands extend in some cases far beyond the lipid bilayer. hese strands could not have been predicted as transmembrane along their entire length, and our model predicts only the part of the strand that it is inserted into the membrane. 178 is a perfect example of such a case since all of its strands are clearly extending far beyond the membrane by 8 or more residues. n addition to the self-consistency and jacknife test, we performed another independent test. e divided the training set in two datasets of seven proteins each and used the one for training and the other for testing. his procedure was repeated 5 times, choosing randomly 7 different proteins each time, and the results concerning the per-residue accuracy and the correlation coefficient were in the range 0.78 β€“ 0.80 and 0.57 β€“ 0.71 respectively. e also tested the performance of the model on the eisserial urface rotein  (spa) [9], the uter embrane nzyme agp from . coli [10], and the uter embrane obalamin ransporter (tub) from . coli [11] he structures of these proteins have been very recently solved, they have not been included in the training set, and they do not show any significant homology with any protein of the training set. or sp. A, and BtuB the model correctly locates all the transmembrane strands and the proteins' full topologies, whereas for Pagp we get two over-predicted strands. For the three proteins the per-residue accuracy is 90.9% and the correlation coefficient is 0.78.
When we tested the ability of the model to discriminate between outer membrane and globular proteins, the percentage of the correctly classified outer membrane proteins (at a fixed threshold) was 88.8% whereas the percentage of correctly classified globular proteins was 89.2%, (Figure 1). The absolute value of the score threshold obtained this way was 2.995, with values lower than that indicating the possibility of the protein being an outer membrane protein.
Furthermore, we developed a protocol that allowed us to apply the newly developed method to search the complete proteome of E. coli [12] for Ξ²-barrel membrane proteins. The protocol consists of three steps: In the first step we perform a search using the PRED-CLASS algorithm [13], with the aim of identifying and removing Ξ±-helical membrane proteins. According to the PRED-CLASS prediction, 1157 proteins out of 5361 were classified as transmembrane and hence they were removed. In the second step, the remaining proteins were filtered with the SignalP program, for finding the secreted proteins, since it is apparent that the majority, if not all, of the outer membrane proteins posses a signal peptide sequence necessary for the translocation to the outer membrane. In order not to discard potential candidates for being identified as outer membrane proteins, we applied both versions of SignalP, the Neural Network [14] and the Hidden Markov Model [15], and if at least one of them indicated the presence of a signal peptide, the protein was not discarded. Then, the signal peptide predicted by the Neural Network algorithm of SignalP was removed, since this algorithm is more accurate than the Hidden Markov algorithm in locating the correct splicing site from all the candidate proteins. This procedure resulted to 978 proteins. In the third and final step, the remaining 978 protein sequences were submitted to our HMM predictor having set the discrimination score at the pre-specified threshold mentioned above. In total, 236 proteins scored below the threshold for the outer membrane proteins (after excluding fragments and sequences shorter than 60 residues) accounting for 4.4% of the complete proteome. Among the top scoring proteins, 42 are well known outer membrane proteins according to the existing annotation, including many fimbrial proteins, usher proteins and transporters, and 87 were proteins whose annotation was "putative" but suggested that their localization was to the outer membrane. The number of proteins whose annotation suggested that they were misclassified, including a lot of periplasmic proteins and enzymes, was 34, whereas the "putative" misclassified proteins were 23. Finally, the remaining 50 proteins were hypothetical proteins or proteins with completely unknown function. Apparently, the 57 over-predictions probably are resulting from the fact that outer membrane proteins are only a small fraction compared to the whole proteome. Since it is believed that outer membrane proteins constitute around 2β€“4% of the complete proteomes, it is natural that even a method with 99% of correct predictions, will result in a large number of false positives. Nevertheless, given the constrains mentioned above, this method clearly offers a useful tool for the automatic annotation of entire proteomes, since the false positives could be easily removed considering other sequence characteristics.
Comparing our method with the best method proposed so far for the prediction of transmembrane Ξ²-barrel proteins by Martelli et al. [8], as well as with the HMM method proposed by Liu et al. [7], the following points should be mentioned. The HMM-profile based method by Martelli et al. [8], uses as input the evolutionary information included in multiple alignments. The method proposed here, uses as input only the amino acid sequence of the protein, hence it is computationally simpler. Even though our method does not outperform the profile based HMM method by Martelli et al. [8] in the per residue accuracy, when it comes to the number of correctly predicted transmembrane strands and overall topologies, the two methods are practically equivalent. The same argument holds for the case of the discriminative power of the two methods, since the percentage of correctly classified Ξ²-barrel proteins was 84%, and percentage of correctly classified water soluble proteins was 90% as reported in [8], showing that better results can be obtained even without the use of evolutionary information. Concerning the method proposed by Liu et al, which uses as input single sequences, the results about strand localization and overall topology assignment are also comparable with our method, but no discrimination could be performed between outer membrane proteins and soluble ones in their method, thus requiring a separate method for the discrimination purposes. Furthermore in Liu et al [7], no overall measures of accuracy were reported.
Both methods mentioned above use HMMs with architectures quite similar to the model shown here, with minor differences, and this is not a surprise. For the sake of argument, the two most successful methods for the prediction of transmembrane segments of Ξ±-helical membrane proteins use a similar architecture; that architecture reflects the most obvious way to map the biological features of transmembrane proteins to the mathematical formalism of the Hidden Markov Model. Finally, the methodology that we used for the training and the decoding is completely different from those used by Martelli et al. [8], and Liu et al. [7]. Our model was trained according to the Conditional Maximum Likelihood criterion, which differs significantly from the Maximum Likelihood training scheme, performed with the Baum-Welch algorithm, by the two methods mentioned. For the decoding, Martelli et al use the so-called posterior decoding method, with the aid of a dynamic programming algorithm, whereas Liu et al, rely on the traditional Viterbi algorithm. Even when in our tests the N-best decoding does not outperform significantly the Viterbi decoding (data not shown), when it comes to newly discovered proteins, the option to perform decoding with the best method available is a clear advantage.
When our method is compared against the methods developed by Zhai and Saier [3] and Wimley [4], we observe that none of the above methods controlled for the number of false positives and false negatives, since they were not validated statistically. They both report the finding of a number of predicted outer membrane proteins, for which the genome annotation suggested localization to the outer membrane. The fact that we report 236 predicted outer membrane proteins in E. coli proteome, compared to 118 in [3] and 200 in [4], reflects the fact that we chose to retain the threshold obtained from cross-validation. Clearly, in real life applications using our method we could lower the threshold and obtain fewer predictions (<200), with the cost of loosing 5β€“10 outer membrane proteins.
</sections.1>

<sections.2>
Conclusions
e present here a novel method, based on a idden arkov odel, for the prediction of the transmembrane ²-strands of the outer membrane proteins of ram-negative bacteria, and for the discrimination of these proteins from globular proteins. o our knowledge, a idden arkov odel trained with a discriminative method is applied for the first time in molecular biology for such a task. e show here that we can achieve predictions at least equally successful to other existing methods, without the use of evolutionary information. e also showed that the method is powerful when used for discrimination purposes, as it can discriminate outer membrane proteins from water soluble proteins in large datasets with a high accuracy, suggesting that it is a very reliable solution for screening entire genomes of ram negative bacteria, for the discovery of novel ²-barrel proteins as possible drug targets. ompared to other single sequence methods (for both discrimination and strand prediction) our method is unambiguously the best currently available. ompared to multiple sequence methods (requiring evolutionary information) our method achieves comparable results. learly, our method combines equally, higher rates for both strand localization and sequence discrimination, from any existing method.  web server running the application is located in our laboratory and it is the only -based application currently freely available, making our method accessible to scientists around the world. he user may submit a sequence in  format, and has the option to choose between decoding by either the -best algorithm, the standard iterbi algorithm or posterior decoding with a dynamic programming algorithm (igure 2). he output consists of the prediction for the transmembrane strands (igure 3). ptionally the user may obtain a graphical plot showing the posterior probabilities in a 3-state mode (extracellular, periplasmic and transmembrane), which may be useful in the case of ambiguously defined topologies. he application also returns the score used for discrimination purposes thus, helping the user to identify possible ²-barrel outer membrane proteins.Conclusions
We present here a novel method, based on a Hidden Markov Model, for the prediction of the transmembrane Ξ²-strands of the outer membrane proteins of Gram-negative bacteria, and for the discrimination of these proteins from globular proteins. To our knowledge, a Hidden Markov Model trained with a discriminative method is applied for the first time in molecular biology for such a task. We show here that we can achieve predictions at least equally successful to other existing methods, without the use of evolutionary information. We also showed that the method is powerful when used for discrimination purposes, as it can discriminate outer membrane proteins from water soluble proteins in large datasets with a high accuracy, suggesting that it is a very reliable solution for screening entire genomes of Gram negative bacteria, for the discovery of novel Ξ²-barrel proteins as possible drug targets. Compared to other single sequence methods (for both discrimination and strand prediction) our method is unambiguously the best currently available. Compared to multiple sequence methods (requiring evolutionary information) our method achieves comparable results. Clearly, our method combines equally, higher rates for both strand localization and sequence discrimination, from any existing method. A web server running the application is located in our laboratory and it is the only HMM-based application currently freely available, making our method accessible to scientists around the world. The user may submit a sequence in FASTA format, and has the option to choose between decoding by either the N-best algorithm, the standard Viterbi algorithm or posterior decoding with a dynamic programming algorithm (Figure 2). The output consists of the prediction for the transmembrane strands (Figure 3). Optionally the user may obtain a graphical plot showing the posterior probabilities in a 3-state mode (extracellular, periplasmic and transmembrane), which may be useful in the case of ambiguously defined topologies. The application also returns the score used for discrimination purposes thus, helping the user to identify possible Ξ²-barrel outer membrane proteins.
</sections.2>

<sections.3>
Materials and methods
he idden arkov odel. Hidden Markov Models have been extensively used for pattern recognition problems, with the most known example found in the speech recognition methodology [16]. Hidden Markov Models have been used in bioinformatics during the last few years for generating probabilistic profiles for protein families [17], the prediction of transmembrane helices in proteins [18,19], the prediction of signal peptides and their cleavage sites [15], the prediction of genes [20] and recently for the prediction of the transmembrane Ξ²-strands [7,8]. An excellent introduction of those applications in molecular biology is the book of Durbin et al [21] whose notation will follow hereafter.The Hidden Markov Model is a probabilistic model consisting of several states, connected by means of the transition probabilities, thus forming a markov process. If we consider an aminoacid sequence of a protein with length L, denoted by:x = x1, x2,..., xL,with a labeling (corresponding to transmembrane, intracellular and extracellular regions):y = y1, y2,..., yLthen, the transition probability for jumping from a state k to a state l is defined as:Ξ±kl = P(Ο€i = l|Ο€i-1 = k)Where Ο€ is the "path" in the particular position of the amino acid sequence (i.e. the sequence of states, as opposed to the sequence of symbols). Each state k is associated with a distribution of emission probabilities, meaning the probabilities that any particular symbol could be emitted by the current state. Assuming an alphabet Ξ£, consisting of the symbols corresponding to the 20 amino acids, the probability that a particular amino-acid b is emitted from state k is defined as:ek(b) = P(xi = b|Ο€i = k)The term 'hidden' is justified by the fact that when one observes the emitted symbols he cannot see the underlying states, thus the true state process is hidden from the observer. The total probability of the observation sequence given the model, P(x|ΞΈ), is computed using the efficient Forward algorithm [16], whereas the joint probability of the sequence and the labeling denoted by P(x,y|ΞΈ), by its trivial modification proposed by Krogh [22].Training and decoding algorithmsTraditionally, the parameters of a Hidden Markov Model are optimized according to the Maximum Likelihood criterion [16],A widely used algorithm for this task is the efficient Baum-Welch algorithm (also known as Forward-Backward) [16,23], which is a special case of the Expectation-Maximization (EM) algorithm, proposed for Maximum Likelihood (ML) estimation for incomplete data [24]. The algorithm, updates iteratively the model parameters (emission and transition probabilities), with the use of their expectations, computed with the use of the Forward and Backward algorithms. Convergence to at least a local maximum of the likelihood is guaranteed. The main disadvantage of ML training is that it is not discriminative. In this work, we used Conditional Maximum Likelihood (CML) training for labeled data, as proposed by Krogh [25]. The Conditional Maximum Likelihood criterion is:This kind of training, often referred to as discriminating training, seeks to maximize the probability of the correct prediction, i.e. the probability of the labeling y for a given sequence x and a model ΞΈ. The parameters of the model (transition and emission probabilities) are updated simultaneously, using the gradients of the likelihood function as described in [26], and the training process terminates when the likelihood does not increase beyond a pre-specified threshold. To reduce the number of the free parameters of the model, and thus improve the generalization capability, states expecting to have the same emission probabilities, were tied together (Figure 4). Furthermore, to avoid overfitting, the iterations started from emission probabilities corresponding to the initial amino-acid frequencies observed in the known protein structures and small pseudocounts were added in each step.The decoding was performed using the N-best algorithm [27] (Figure 5), as formulated in [25]. This algorithm is a heuristic that attempts to find the most probable labeling of a given sequence, as opposed to the well-known Viterbi algorithm [16], which guarantees to find the most probable path of states. Since there are several states contributing to the same labeling of a given sequence (as in our case), the N-best algorithm will always produce a labeling with a probability at least as high as that computed by the Viterbi algorithm, in other words it always returns equal if not better results. Its main drawback is the memory requirements and computational complexity, resulting in a slowdown of the decoding process. For the purpose of discrimination, the information included in the prediction of the putative TM segments is not sufficient, since a prediction for a transmembrane strand could occur even in globular proteins. Thus, there is need for a global predictor reflecting the overall fit of the query sequence to the model. This predictor is the negative log-likelihood of the sequence given the model, as computed by the Forward algorithm and normalized for the length of the sequence. Thus, the statistical score used for discrimination is:where L is the length of the sequence. We studied the proportion of correctly classified proteins as a function of the discrimination score used as the threshold. We defined the optimal threshold as the value that maximizes that function. Proteins with score values below the threshold should be declared as beta-barrel membrane proteins. All algorithms and tools used throughout this work have been implemented by the authors, using the Java programming language by Sun Microsystems.The model architectureThe model that we used is cyclic, consisting of 61 states, (Figure 4). The architecture has been chosen so that it could fit as much as possible to the limitations imposed by the known structures. The model consists of three "sub-models" corresponding to the three desired labels to predict, the TM (transmembrane) strand sub-model and the inner and outer loops sub-models respectively. The TM strand model incorporates states to model the special architecture of the transmembrane strands. Thus, there are states that correspond to the core of the strand and the aromatic belt located at the lipid bilayer interface. Furthermore, other states correspond to the amino acid residues facing the bilayer (the external side of the barrel) and the residues facing the barrel interior. All states are connected with the appropriate transition probabilities in order to be consistent with the known structures (i.e. to ensure appropriate length distributions and to model the alternating pattern of hydrophobic-non hydrophobic residues, corresponding to the external-internal residues of the barrel). The minimum allowed length for a transmembrane strand is 7 residues, whereas the maximum is 17.The inner and outer loops are modeled with a "ladder" architecture, whereas at the top of the outer loop there is a self transitioning state corresponding to residues too distant from the membrane; these cannot be modeled as loops, hence that state is named "globular". The "inner" loop sub-model has no corresponding "globular" state, reflecting the fact that inner loops are significantly shorter than the outer ones, since none of the known structures possesses an inner loop longer than twelve residues. In order to capture the fact that all known structures are having their N-terminal tail falling into the periplasmic space (the "inside" with respect to the outer membrane) we allowed the begin state of the model to be followed only by states belonging to the inner loop or to TM strands directing to the external side of the outer membrane. Finally, we allowed a self-transitioning absorbing state to follow the inner loop states, in order to correctly model sequences that have a long C-terminus falling in the periplasmic space. States expected to have the same emission probabilities are tied together.Training and testing setsThe training set that we used has been compiled with consideration of the SCOP classification [28]. In particular, we selected all PDB codes from SCOP that belong to the fold "Transmembrane beta-barrels", and obtained the corresponding structures from the Protein Data Bank (PDB) [29]. For variants of the same protein, we kept the structure solved at the highest resolution, and we removed multiple chains, keeping only one chain for each structure. The sequences of the remaining structures have been submitted to a redundancy check, removing chains with a sequence identity above some threshold. We considered two sequences as being homologues, if they demonstrated an identity above 30% in a pairwise alignment, in a length longer than 80 residues. For the pairwise local alignment we used BlastP [30] with default parameters, and the homologous sequences were removed implementing Algorithm 2 from Hobom et al [31]. The remaining 14 outer membrane proteins constitute our training set (Table 1). The structures of TolC [32] and alpha-hemolysin [33], were not included in the training set for the following reasons: TolC is a mixed beta-barrel and alpha-helical protein which spans both the outer membrane and the periplasmic space of gram negative bacteria. Three TolC protomers assemble to form a continuous, solvent accessible conduit, a "channel-tunnel" over 140 Γ… long. Each monomer of the trimer contributes 4 Ξ²-strands to the 12 strand Ξ²-barrel. Alpha-hemolysin secreted from S. aureus is active as a transmembrane heptamer, where the transmembrane domain is a 14-strand antiparallel Ξ²-barrel, in which two strands are contributed by each monomer. Both structures are not included in the fold "transmembrane beta-barrel" of the SCOP database. In summary, the set includes proteins being monomeric, dimeric or trimeric, with a number of TM Ξ²-strands ranging from 8 to 22, and is representative of the known functions of outer membrane proteins. As an independent test set of outer membrane proteins, we chose the dataset used in the validation of the PSORT-B algorithm [34], consisting of 377 proteins. This set was also checked for redundancy with the same criteria mentioned above, and the closest homologues were removed along with the proteins showing similarity to at least one protein from the training set, leaving us with 119 outer membrane proteins. To test the discriminative power of the model we used an additional dataset of globular proteins, with 3-dimensional structures deposited in PDB [29]. This set was compiled using the PAPIA [35] server, with the sequence similarity threshold set to 25%, and excluding membrane proteins, proteins with a length lower than 80 residues, and proteins with at least one unidentifiable residue in the sequence; finally we came up with 1100 sequences of such globular proteins.It is noteworthy that even in structures known at atomic resolution, the exact boundaries of the TM strands are not obvious, and in some situations the PDB annotations for the strands are clearly extending far beyond the membrane. Since our primary objective was to predict the TM segments of the strands rather than the entire Ξ²-strands, the model was trained to identify these particular segments. It is well known that discriminative training algorithms are very sensitive to data mislabeling, thus the training could not have been performed with labels based on the PDB annotation for the TM-strands. In [18], an automated method for re-labeling the data was proposed, but in our case since the training data set was limited we chose a manual approach. For the training purposes, the labels for the TM segments were set manually, by identifying the aromatic belts of the barrel [2] after inspection of the 3-dimensional structures of the proteins of the training set using molecular graphics. All residues contained between the two aromatic belts of each Ξ²-strand of the Ξ²-barrel were set to define a TM segment, including the residues of the belts. In cases where the aromatic belt residues of a Ξ²-strand are not clearly defined, neighbouring Ξ²-strands of the Ξ²-barrel helped in the "belt" identification. The resulting dataset used for training is shown in additional file 1 (second column, TM).Measures of accuracyTo assess the accuracy of the predictions, we used several measures. For the transmembrane strand predictions we calculated the number of correctly predicted strands (True Positives, TP), the number of missed strands (False Negatives, FN) and the number of the over-predicted strands (False Positives, FP). We also calculated the total number of correctly predicted topologies, i.e. when both the strand localization and the loops topology have been predicted correctly. As measures of the accuracy per residue, we report here both the total fraction of the correctly predicted residues (QΞ²) in a two-state model (transmembrane versus non-transmembrane), and the well known Matthews Correlation Coefficient (CΞ²) [36]. The comparisons have been performed against our manual annotation of the TM segments to show the efficiency of the model as well as against the PDB annotation for the transmembrane strands, for demonstration purposes. We feel that this had to be done in order to allow a fair comparison with other published methods [6-8], since in each one of the published methods the comparisons were performed against the PDB annotation.
</sections.3>

<sections.4>
Authors' contributions
 carried out the design of the algorithms and the model, the data collection, the training and testing procedures, and also participated in the implementation.  implemented most of the algorithms, and also participated in the model design.  created the web interface.  coordinated the whole project, suggesting the general directions and innovating features of the method. ll authors have read and accepted the final manuscript.Authors' contributions
PB carried out the design of the algorithms and the model, the data collection, the training and testing procedures, and also participated in the implementation. TL implemented most of the algorithms, and also participated in the model design. IS created the web interface. SH coordinated the whole project, suggesting the general directions and innovating features of the method. All authors have read and accepted the final manuscript.
</sections.4>

<sections.5>
Supplementary aterial
dditional ile 15.63 kb, a list of the observed ²-strands taken from  [29], the manually annotated transmembrane segments (), and the predicted transmembrane segments of the 14 proteins of the training set.lick here for fileSupplementary Material
Additional File 15.63 kb, a list of the observed Ξ²-strands taken from PDB [29], the manually annotated transmembrane segments (TM), and the predicted transmembrane segments of the 14 proteins of the training set.Click here for file
</sections.5>

</text>
