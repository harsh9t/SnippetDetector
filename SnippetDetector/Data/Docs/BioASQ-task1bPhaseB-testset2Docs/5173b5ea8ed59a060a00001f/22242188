<title>
Combinations of histone modifications mark exon inclusion levels.
</title>

<text>

<sections.0>
Introduction
he human genome contains around 20 000 genes and currently around 140 000 transcripts coding for different protein isoforms are known [1]. he process of concatenating the exons into a complete transcript, splicing, involves elimination of introns and specific exons and is performed by the spliceosome; a massive complex containing hundreds of proteins [2]. he constitution and function of the spliceosome is not yet fully known. he vast majority of eukaryotic introns end and start with specific sequences,  and  and these acceptor- and donor-sites constitute an invariant part of a signal by which specific subunits of the spliceosome can recognize the intron-exon boundaries [3]. n the m. RNA-level, there are also exonic and intronic splicing enhancers (ESEs and ISEs) and silencers (ESSs and ISSs) [4], [5] These are short (6β€“8 nucleotides) sequence motifs that can be bound by proteins that further guide the splicing process. Recently, it has been suggested that in a given cell type, sequence information alone is enough to distinguish constitutively spliced exons from alternatively spliced exons [5]. However, this sequence-based system for splicing is not sufficient since different protein isoforms are produced by different cell types [6], and so the cell needs to regulate the splicing through a system not locked into the sequence itself. These epigenetic mechanisms are not the sole answer [7], but several DNA-binding proteins and chromatin remodelers have been shown to be important, and recently, post translational modifications to the histone proteins have been shown to, at least partly, regulate exon inclusion/exclusion [8], [9], [10], [11], [12] in gene transcripts. Conceptually, splicing can be achieved in two ways, either post-transcriptional or co-transcriptional. The classical textbook model is post-transcriptional where the whole mRNA is first transcribed and then the introns and, possibly, some exons are removed. Recently, the co-transcriptional model has been proposed [13], [14], [15], [16], [17] where inclusion/exclusion of a specific exon into the mRNA is decided before the whole mRNA is transcribed. The co-transcriptional model puts the spliceosome close to the DNA during transcription and it thus has the possibility to read and recognize the histone code.
Recently, a number of studies [8], [9], [10], [12], [18], [19] have shown genome-wide correlation between specific nucleosome modifications over internal exons and the exons expression and specifically, Luco et al [11] demonstrated histone modification mediated splice site selection in a set of genes. Taken together, this suggests an epigenetic signalling platform that could both serve as recognition of splice sites and determine inclusion and exclusion of exons into transcripts. Current studies on epigenetic control of expression focus on finding the strongest relations between a single histone modification and the expression of the exon and the combinatorial aspects have not yet been comprehensively addressed [20]. Here we present a combinatorial rule-based model that better reflects a part of the complex biological machinery behind splicing. Following our recent study [8] on nucleosome positioning and histone modifications over internal exons, we have now created a data-driven model which predicts exon inclusion levels from a binary (present/absent) representation of modifications to nucleosomes preceding, on, or succeeding the individual exon.
</sections.0>

<sections.1>
Results and iscussion
he rule-based model was created using the most comprehensive data set on histone methylations and acetylations [21], [22] available to date. n all, 38 histone modifications are available in 4+ -cells and these where used to build a decision system with the modifications as attributes and exon inclusion or exclusion based on exon expression [23] data as decision. or each histone modification we considered regions preceding and succeeding the exons as well as centred over the exon giving a total of 114 attributes (3*38). ach histone modification was discretized as present or absent over the three regions (ethods). he generated rules are in the form of β€� β€¦  ..β€� and a typical rule will read as β€� 25me1 preceding exon is absent  34me1 succeeding exon is present  336me3 succeeding exon is absent  429me1 preceding exon is present  exon is excludedβ€�. his means that the model is in human readable form and thus immediately interpretable and could be used as starting point for detailed experimental investigation on the interplay between histone modifications in relation to alternative splicing.
he data set used to train the model was carefully constructed. he inclusion level of an exon in a gene was determined by first calculating the expression of the gene as an average over the ten highest expressed exons annotated to that gene. he exon inclusion level was then calculated as the quote between the exon expression and the average gene expression, and the exons with an inclusion level below 0.4 or between 0.9 and 1.1 were annotated as β€�spliced outβ€™ or β€�includedβ€™, respectively. he exons were then filtered using several criteria. irstly, we excluded the top 20% expressed genes as it has previously been postulated that, due to frequent polymerase  traffic, highly expressed genes are depleted of nucleosomes [24]. econdly, we removed exons ranked first or last in any transcript and required that the exons were at least 50 bp long, flanked by at least 360 bp of intronic sequences (ethods). astly, we removed any exons that overlapped another exon.  schematic representation of the data is shown in igure 1. he final data set of excluded exons contained 11 165 unique examples and we randomly selected the same number of unique exons from the 12 692 examples in the included class to get balanced classes for the training of the model. his was repeated ten times to catch variations of the results based on the selection of examples and the heuristic algorithms used for rule generation.
10.1371/journal.pone.0029911.g001igure 1chematic representation of the constructed data set.or each histone modification, e.g. 336me3, we deem it as present or absent in the region centred over the exon and the regions preceding and succeeding depending on if the histone modification pileup in such region is higher than a defined cut-off. his cut-off is specific for each histone modification since they were sequenced at difference depths.he attributes most contributing to the decisions were ranked using onte arlo feature selection [25] and the 20 highest ranked of the original 114 attributes were kept. trikingly, modification to nucleosomes immediately preceding and succeeding the exon were often ranked higher than their counterparts β€�centred onβ€™ exons and among the 20 selected attributes, only two were centred on the exon (able 1). he 20 top-ranked attributes were used to build a rule-based classifier using the osetta system [26]. n order to prevent over-fitting of the rule model, we generated so-called approximate reducts and filtered the generated rules on both accuracy and support (ethods). he final model consisted of 165 rules and covered 27% of the selected exons. he performance of the primary model was assessed by a 10-fold cross validation schema for the ten data sets and yielded an average accuracy of 71.9% with a standard deviation of 0.3%. his accuracy is considerably higher than the 50% that would be expected by random guessing on the two equally sized data sets. istone modifications previously [8], [9] identified as related to exon expression were present in the rules (e.g. 25me1 and 420me1) as well as previously less well-studied modifications. owever, the strongest univariate candidates [8], [9], [10], [11] e.g. 379me1, 379me3 and 336me3, were all selected as significant by the , but only 336me3 succeeding and preceding the exon were among the 20 highest ranked modifications and thus included in the rule model. urprisingly, 336me3 was always required to be β€�absentβ€™ in the rules for both decisions although it has previously been suggested that its presence is related to inclusion [8], [10], [11]. hese results lead us to investigate the properties of the 336me3 histone modification in particular and we could conclude that the distribution of this specific mark was too similar (able 2) over both our classes for its presence/absence to constitute a rule in itself. hen 336me3 was explicitly absent, however, it the model was able to distinguish between β€�includedβ€™ and β€�spliced outβ€™ exons using combinations with other marks.
n the model, the number of condition attributes in the rules varied between two and nine (igure 1). he most common number of condition attributes was five (56%) for the β€�spliced outβ€™ class and six to eight (75%) for the β€�includedβ€™ class. n total 66% of the rules in contained 6β€“8 condition attributes and no rules consisted of a single attribute. nly 6 rules out of the total 165 did not require at least one histone modification to be absent from the region. he complexity of the interplay between histone modifications is illustrated in igure 2, demonstrating pair-wise co-occurrence of attributes in the rules predicting β€�spliced outβ€™. e calculated the predicted accuracy of the rules assuming that the histone modifications were independent from each other (ethods). f the accuracy of a rule is greater than the predicted sum of its parts, this corresponds to rules where the combination indeed gives more information about the exon inclusion level than what can be obtained using only one attribute at a time. f it is not, it could be explained by correlation between attributes in the rules, or by rules that only summarize the contribution of independent attributes. any of the histone modifications are indeed expected to be correlated and, moreover, modifications present e.g. centred on the exon are often accompanied by modifications in the flanking introns and vice versa.
10.1371/journal.pone.0029911.g002igure 2air-wise co-occurrence of histone modifications in the model.() ules predicting β€�spliced outβ€™. ny each histone modification that occurs in any rule is labelled on the outer ring, and co-occurrence with other histone modifications are illustrated by ribbons across the circle. he width of the ribbon correlates to the number of rules where the two modifications co-occur as attributes. olouring of the ribbons indicates ranking of number of rules with the given pair over the whole model with the lower 75% coloured in grey. he colours of the inner ring correspond to the colour in the outer ring in the other end of a given ribbon. he figure labels are β€�β€™: 25me1, β€�β€™: 336me3, β€�β€™: 34me1, β€�β€™: 39me1, β€�β€™: 39me2, β€�β€™: 39me3, β€�β€™: 32me1, β€�β€™: 416ac, β€�β€™: 420me1, β€�β€™: 491ac; : succeeding the exon, : preceding the exon, : on the exon; 0: is absent, 1: is present (e.g. β€� 0β€� is interpreted as β€�25me1 preceding the exon is absentβ€�). () ame as () but for the rules predicting β€�includedβ€™ exons. mages was generated using ircos [29].e observed an overall combinatorial effect for the β€�spliced outβ€™ class where 23 out of the 32 rules had a combinatorial gain in accuracy (able 3) and 4 of them had a gain of more than 10 percentage units. his suggests that the attributes, e.g. histone modifications, in rules predicting β€�spliced outβ€™ exons share control of exon inclusion levels and are not only independent correlations taken together. he rules for the β€�includedβ€™ class were of a different character. hey contained, in general, more attributes and many of these were required to be absent. nly 2 out of the 133 rules showed a combinatorial gain, and we did not find specific patterns for inclusion, but rather a description of the background state exons without any β€�spliced outβ€™ signals. he pair wise co-occurrence of attributes for the β€�includedβ€™ class is illustrated in igure 2. he five top-ranked rules for both classes are shown in able 1, and footprints for the exons that fulfilled some of these are shown in igure 3β€“. ote that there all histone modification signals were low when the class is β€�includedβ€™ (igure 3), which confirmed that this correspond to a background state of an exon.
10.1371/journal.pone.0029911.g003igure 3ootprints of rules from the model.he footprints are centred on intron-exon junctions (/) with examples of rules in the model from the () β€�pliced outβ€™ class (covers 358 exons, β�’6 pp accuracy gain over independent histone, referred to as 1 in able 1), () β€�pliced outβ€™ (296, +5 pp, 3), () β€�pliced outβ€™ (260, +12 pp, 5) and () β€�ncludedβ€™ (3738, β�’8 pp, 1). he number of reads normalized to sequence depth as left axis.10.1371/journal.pone.0029911.t001able 1op-ranked rules. ule. SupportAccuracyComb gainP-valueS1H2BK5me1.precβ€�=β€�1 H2BK5me1.succβ€�=β€�1 H3K4me1.succβ€�=β€�0 H3K36me3.precβ€�=β€�0 H3K36me3.succβ€�=β€�0 H4K20me1.precβ€�=β€�1 H4K91ac.precβ€�=β€�13580.737β�’6.11.54E-025S2H3K9me1.precβ€�=β€�1 H3K4me1.precβ€�=β€�0 H3K36me3.succβ€�=β€�0 H4K20me1.succβ€�=β€�1 H4K91ac.precβ€�=β€�13070.733+1.42.18E-021S3H2BK5me1.precβ€�=β€�1 H2BK5me1.succβ€�=β€�1 H3K36me3.precβ€�=β€�0 H3K36me3.succβ€�=β€�0 H4K20me1.precβ€�=β€�1 H4K91ac.succβ€�=β€�02960.736+4.63.30E-021S4H3K4me1.precβ€�=β€�0 H3K4me1.succβ€�=β€�1 H3K36me3.succβ€�=β€�0 H4K20me1.precβ€�=β€�1 H4K91ac.precβ€�=β€�11950.785+4.49.48E-020S5H2BK5me1.precβ€�=β€�0 H3K4me1.succβ€�=β€�1 H3K36me3.succβ€�=β€�0 H4K20me1.succβ€�=β€�12600.738+11.84.62E-019I1H2BK5me1.precβ€�=β€�0 H2BK5me1.succβ€�=β€�0 H3K9me1.precβ€�=β€�0 H3K36me3.precβ€�=β€�0 H3K36me3.succβ€�=β€�0 H4K16ac.precβ€�=β€�0 H4K20me1.precβ€�=β€�0 H4K91ac.precβ€�=β€�0 H4K91ac.succβ€�=β€�037380.775β�’7.56.99E-244I2H2BK5me1.precβ€�=β€�0 H2BK5me1.succβ€�=β€�0 H3K9me1.precβ€�=β€�0 H3K36me3.precβ€�=β€�0 H3K36me3.succβ€�=β€�0 H4K16ac.precβ€�=β€�0 H4K20me1.succβ€�=β€�0 H4K91ac.precβ€�=β€�0 H4K91ac.succβ€�=β€�037370.774β�’7.75.28E-242I3H2BK5me1.precβ€�=β€�0 H2BK5me1.succβ€�=β€�0 H3R2me1.precβ€�=β€�0 H3K9me1.precβ€�=β€�0 H3K4me1.succβ€�=β€�0 H3K36me3.precβ€�=β€�0 H3K36me3.succβ€�=β€�0 H4K91ac.precβ€�=β€�0 H4K91ac.succβ€�=β€�032820.784β�’5.64.74E-227I4H2BK5me1.precβ€�=β€�0 H2BK5me1.succβ€�=β€�0 H3R2me1.precβ€�=β€�0 H3K9me1.precβ€�=β€�0 H3K36me3.precβ€�=β€�0 H3K36me3.succβ€�=β€�0 H4K16ac.precβ€�=β€�0 H4K20me1.precβ€�=β€�0 H4K91ac.succβ€�=β€�030260.783β�’5.92.72E-205I5H2BK5me1.precβ€�=β€�0 H2BK5me1.succβ€�=β€�0 H3R2me1.precβ€�=β€�0 H3K9me1.precβ€�=β€�0 H3K36me3.precβ€�=β€�0 H3K36me3.succβ€�=β€�0 H4K16ac.precβ€�=β€�0 H4K20me1.succβ€�=β€�0 H4K91ac.succβ€�=β€�030240.782β�’6.01.22E-202Top ranked rules in the model for β€�Spliced outβ€™ (top) and β€�Includedβ€™ (bottom). The ID column contain a rule identifier in which the first letter indicate the rule outcome (S for β€�spliced outβ€™ and I for β€�includedβ€™). The left-hand side of the rule (LHS Rule) is the conditions in the IF-part of the rule. The support is defined as the number of examples in the data that are covered by the IF-part of the rule and the accuracy is the proportion of the correct decision among those. The combinatorial gain (Comb gain) is the change in accuracy (percentage points) compared to the theoretical accuracy, assuming independent modifications. The P-value denotes the probability of the rule calculated from a hypergeometric distribution.Due to the fact that the model was trained only on exons that did not overlap one another, we expect it to explain splicing of cassette type that can be estimated on cell population level from expression data. The model thus cannot consider e.g. splicing caused by alternative exon boundaries and such events needs to be formulated as a classification problem and additional investigations are required to assess whether other splicing patterns can be predicted using out approach.
In conclusion, we have shown that a substantial proportion of alternative splicing events can be attributed to the combinatorial status of histone modifications on nucleosomes preceding, on, or succeeding the exon and that combination of specific histone modifications are often better predictors of exon inclusion levels than single histone modifications.
</sections.1>

<sections.2>
Methods
xperimental ata. The data used here was based on ChIP-seq histone modification data for 38 methylations and acetylations [21], [22] in CD4+ T cell together with exon expression data [23].A signal assembly for the ChIP-seq fragments was done as described by Andersson et al. [8] and individual fragments were extended to 150 bp and pileup signals was stored in a binary format [27]. To discretize the modification signals to binary (present/absent) attributes for three positions in relation to the exon (preceding, on or succeeding the exon), exons and the closest 180 bp of flanking intronic regions were searched for significant enrichment of the histone modification signals, assuming a Poisson distribution (p<0.05) of the fragments. 80% of the genome was considered mappable in the calculation of the mean signal for the Poisson distribution. The 20 bp closest to the intron/exon or exon/intron junction on both sides were excluded from the search.We considered only internal exons, that is we excluded all exons that where annotated as first or last in any transcript. Exons longer than 50 bp with flanking introns longer than 360 bp and no overlap to other exons were identified. As introns of more than 360 bps were required in the exon selection, the intronic regions selected for consecutive exon could never overlap one another. The gene expression may theoretically be approximated as the highest expression of an exon in the gene, but to avoid high noise impact the gene expression was calculated from the exon expression as the average of the ten highest expressed exons in the gene. The 20% highest expressed genes were excluded from the study and the inclusion levels of the remaining exons were calculated as the exon expression divided by the gene expression. Genes with only one exon were excluded and among the remaining exons 13 374 which had an inclusion level below 0.4 were annotated as β€�spliced outβ€™ and 11 587 which had an inclusion level between 0.9 and 1.1 were annotated as β€�includedβ€™. Exons with no modifications present were removed from the data, which gave in total 12 692 β€�includedβ€™ and 11 165 β€�spliced outβ€™ exons. All annotation data on exons were taken from the Ensembl [28] system (H.Sapiens 54_36p).Model generation and validationThe decision table was created with exons from all autosomes, taking the histone modifications as condition attributes and the exon inclusion level as decision. The two inclusion level classes β€�spliced outβ€™ and β€�includedβ€™ were roughly of similar size why all those exons were used in the Monte Carlo feature selection (MCFS). The MCFS was performed using dmLab 1.70 [25] with the parameters sβ€�=β€�5 000, mβ€�=β€�10, tβ€�=β€�5, uβ€�=β€�0 and vβ€�=β€�1. The remaining settings were mcfs.classifierβ€�=β€�j48, mcfs.splitRatioβ€�=β€�0.66, mcfs.balanceClassesβ€�=β€�true, mcfs.balanceRartioβ€�=β€�1, mcfs.cutPointRunsβ€�=β€�30, mcfs.cutPointAlphaβ€�=β€�0.05 and j48.useInfoGainβ€�=β€�false. The rankings are shown in Table S1. Out of 114 attributes, 94 were found significant (p<0.05) using a randomization test. The 20 highest ranked attributes were kept for the rule generation step.Rules were generated in Rosetta [26] with the JohnsonReducer, relative to the objects and using approximate reducts with a hitting fraction of 0.80. All 11 165 exons from the β€�spliced outβ€™ class were selected together with approximately the same number from the β€�includedβ€™ class to define a training set with an equal number of examples from each decision class. This was repeated ten times to construct ten different data sets. On each of those data sets, a rule model was trained and a 10-fold cross validation was performed to assess the performance of the rule model. The cross validation results were averaged and the rules trained on all data sets were merged together, and rule accuracy and support were re-calculated on the original data. The support was calculated as the number of examples that fit the conditions on the left-hand side of the rule, and accuracy as the number of correctly classified objects by the rule divided by the rule support.Footprints visualizing the mean modification signal-per-bp for all exons supporting each rule were created using the SICTIN software [27]. The number of exons that is covered by a rule was defined as the number of exons that fulfil the IF-part of the rule.The predicted rule accuracy was calculated assuming linear independence between the attributes and was calculated as |T|pT1pT2β€¦pTn/(|T|pT1pT2β€¦pTn+|F|pF1pF2β€¦pFn) were T is the set of objects in the decision class of the rule, F is the objects in the other classes, and pCi is the probability that an object from class C fulfil condition number i. The probabilities were estimated by counting the proportion of objects from each class that passed each condition.
</sections.2>

<sections.3>
Supporting nformation
igure 1ule length. he number of rules for the classes β€�pliced outβ€™ and β€�ncludedβ€™ shown split on the number of attributes in the  of the rules.()lick here for additional data file.able 1anking of the histone modifications by their relative importance (). he -value shows the significance of the s relative the permutation test. he 20 highest ranked attributes (marked by an β€�xβ€™ to the left) were kept for rule generation.()lick here for additional data file.able 2xon inclusion depending on the presence of histone modifications. nclusion percent is defined as the percentage of exons from the β€�includedβ€™ class.()lick here for additional data file.able 3ll rules in the classifier. ach rule is represented as a list of the conditions in the rule (ule) and the decision outcome (lass). he support is defined as the number of examples in the data that are covered by the -part of the rule and the accuracy is the proportion of the correct decision among those. he theoretical accuracy was calculated assuming independent modifications, and the combinatorial gain (omb gain) is the change in accuracy (percentage points) between the accuracy and the theoretical accuracy. he -value denotes the probability of the rule calculated from a hypergeometric distribution.()lick here for additional data file.Supporting Information
Figure S1Rule length. The number of rules for the classes β€�Spliced outβ€™ and β€�Includedβ€™ shown split on the number of attributes in the LHS of the rules.(TIF)Click here for additional data file.Table S1Ranking of the histone modifications by their relative importance (RI). The P-value shows the significance of the RIs relative the permutation test. The 20 highest ranked attributes (marked by an β€�xβ€™ to the left) were kept for rule generation.(DOC)Click here for additional data file.Table S2Exon inclusion depending on the presence of histone modifications. Inclusion percent is defined as the percentage of exons from the β€�includedβ€™ class.(DOC)Click here for additional data file.Table S3All rules in the classifier. Each rule is represented as a list of the conditions in the rule (Rule) and the decision outcome (Class). The support is defined as the number of examples in the data that are covered by the IF-part of the rule and the accuracy is the proportion of the correct decision among those. The theoretical accuracy was calculated assuming independent modifications, and the combinatorial gain (Comb gain) is the change in accuracy (percentage points) between the accuracy and the theoretical accuracy. The P-value denotes the probability of the rule calculated from a hypergeometric distribution.(XLS)Click here for additional data file.
</sections.3>

</text>
