<title>
ImOSM: intermittent evolution and robustness of phylogenetic methods.
</title>

<text>

<sections.0>
Introduction
hylogenetic reconstruction comprises three approaches: maximum parsimony (), distance-based methods (e.g., neighbor joining [] and ), and statistical approaches including maximum likelihood () and ayesian inference (felsenstein2004 and references therein).  uses an implicit model of sequence evolution, whereas the latter two assume an explicit evolutionary model. vailable software packages such as  (elsenstein 1993), * (wofford 2002), hy. ML (Guindon and Gascuel 2003), IQPNNI (Vinh and von Haeseler 2004, Minh et al. 2005), MEGA4 (Kumar et al. 2008), RAxML (Stamatakis et al. 2008), and MrBayes (Huelsenbeck and Ronquist 2001) allow phylogenetic reconstruction under increasingly complex evolutionary models. This enables more and more studies to gain insights into the performance of different tree-building methods under various scenarios (e.g. Felsenstein 1978, huelsenbeck1993, huelsenbeck1995, 1995b; [pp. 185β€“204 and references therein], pp. 185β€“204 and references therein). For analyses of real data, such studies may then help to have a better understanding of possible pitfalls of the inferred phylogenies, as some observations might be due to reconstruction artifacts such as long-branch attraction (see., e.g., Anderson and Swofford 2004, Brinkmann et al. 2005)
Performance of phylogenetic reconstruction methods can be evaluated under several criteria such as consistency (the ability to estimate the correct tree with sufficient data), efficiency (the ability to quickly converge on the correct phylogeny), and robustness (the ability to infer the correct tree in the presence of model violation, see, e.g., Yang 2006, p. 186β€“190). Among these, robustness to incorrect assumptions about the underlying evolutionary model is of particular practical importance as complete and accurate a priori knowledge of evolutionary processes is typically unavailable. Previous studies of robustness (e.g., Yang 1997, bruno1999, sullivan2001, lemmon2004) used an evolutionary model and a tree to generate alignments and then assessed the accuracy of phylogenetic methods using different models of sequence evolution. Accuracy is measured by the proportion of generated alignments yielding the true tree.
Using one evolutionary model for the whole tree and for all sites to generate data is evidently a simplification (see, e.g., Lopez et al. 2002). Such a model is certainly not adequate to describe the complicated evolutionary process. Thus, more sophisticated studies of robustness have employed several techniques to model the evolutionary process more realistically, such as adding different guanine and cytosine (GC) content to different parts of the simulated data (Kolaczkowski and Thornton 2009), changing the proportions of variable sites across the tree (Shavit Grievink et al. 2010) and using different sets of branch lengths to simulate partitioned data (Kolaczkowski and Thornton 2004, kolaczkowski2009, spencer2005).
Currently available sequence simulation programs incorporate increasingly complex evolutionary scenarios to account for insertion and deletion events (e.g., Fletcher and Yang 2009), lineage-specific models (Shavit Grievink et al. 2008) or site-specific interactions (Gesell and von Haeseler 2006). Nonetheless, studies of robustness in phylogenetic inference need an additional utility: a systematic means to introduce model violation to the simulated alignments. We therefore introduce ImOSM, a flexible tool to β€�pepperβ€� a model tree with well-defined deviations from the original model.
ImOSM simulates β€�intermittent evolution,β€� where intermittent evolution refers to extra substitution(s) that are thrown on arbitrary branch(es) of the tree to convert a site pattern of the alignment into another site pattern. Extra substitutions are modeled by the one-step mutation (OSM) matrix (Klaere et al. 2008). Thus, ImOSM actually β€�imbeds one-step mutationsβ€� into the alignment. ImOSM provides a variety of settings, which allow for different model violation scenarios such as violating the substitution rates or rates across sites (RaS) along certain branches of the tree.
Using ImOSM to violate the underlying model, we report that the reconstruction accuracy of ML, MP, and BIONJ all suffer severely from RaS heterogeneity violation and a simultaneous violation of RaS and the transition/transversion (Ts/Tv) ratio along two nonadjacent external branches of a four-taxon tree. For an eight-taxon balanced tree, such violations cause each of the three methods to produce a different topology, and BIONJ constantly infers the true tree if the sequence length is large (β‰¥105). Subsequently, we examine possible topological biases and perform several tests regarding the model and the inferred tree. Based on this, recommendations for phylogenetic analyses of real data are drawn.
</sections.0>

<sections.1>
Materials and ethods
m. OSM MethodAssume that we have a phylogenetic tree π�’― and an alignment π�’� that evolved along π�’― under a model of sequence evolution β„³. ImOSM introduces extra substitutions that occur somewhere on π�’―, thus changing the alignment π�’�, which otherwise perfectly fits the substitution process defined by β„³. To this end, we utilize the concept of an OSM matrix (Klaere et al. 2008) applied to the Kimura three parameter (K3ST) model (Kimura 1981). The K3ST model distinguishes three classes of substitutions: 1) transitions (s1) within purines (A,G) and pyrimidines (C,T), 2) transversions (s2) within the nucleotide pairs (A,C) and (G,T), and 3) transversions (s3) within the nucleotide pairs (A,T) and (G,C). Figure 1 illustrates the connection between the K3ST model and the OSM matrix. For the left branch of the two taxon tree (fig. 1a), a transition s1 of the K3ST model (fig. 1b) produces a unique 16Γ—16-dimensional (permutation) matrix Οƒ11 (fig. 1c). Each row and each column of the matrix has exactly one nonzero entry, which describes how a transition changes a pattern (row) into a new pattern (column).Fig 1.(a) A rooted tree with leaves 1 and 2. (b) The K3ST model (Kimura 1981). A transition s1 on the left branch of the tree changes a pattern into exactly one new pattern (black square) in the (permutation) matrix (c). The matrix has 16 rows and 16 columns representing the possible site patterns for the alignment of two nucleotide sequences.Klaere et al. (2008) showed how to efficiently construct the (permutation) matrices for every branch in a tree. The construction of the OSM matrix Mπ�’― for the tree π�’― is completed by taking into account the relative contribution of each branch in the tree and the probabilities for the three substitution classes for each branch. Thus, we obtain:where Οƒei is the matrix generated by substitution class siβ��{s1,s2,s3} for branch e, Ξ±e1,Ξ±e2,Ξ±e3 are the probabilities of the three substitution classes for branch e(Ξ±e1 + Ξ±e2 + Ξ±e3 = 1), E the set of all branches of π�’―, and pe the ratio between the branch length of branch e and the sum of all branch lengths (pe β‰¥ 0 and β�‘eβ��Epe = 1). Mπ�’― is the weighted exchangeability matrix for all patterns given that an extra substitution occurs somewhere on the tree π�’―.We now explain the different options ImOSM offers. Given a rooted tree and an alignment, one can, on the one hand, explicitly introduce an extra substitution to change a given alignment site by specifying a substitution class and a branch. For example, an extra substitution s2 occurring on the external branch leading to taxon 1 of the rooted four-taxon tree (fig. 2a) changes the site pattern AACA at the first position (column) of the alignment (fig. 2b) into the pattern CACA. Another extra substitution s3 on the internal branch leading to taxa 3 and 4 changes the site pattern GGAC at the second position into the pattern GGTG. Figure 2c depicts the resulting (disturbed) alignment. This explicit specification is worthwhile if one wants to study the effect of a (small) number of extra substitutions.Fig 2.An example of an explicit setting in ImOSM. An extra substitution s2 occurring on the external branch leading to taxon 1 of the rooted four-taxon tree (a) changes the site pattern AACA at the first position of the alignment (b) into the pattern CACA. An extra substitution s3 on the internal branch leading to taxa 3 and 4 changes the site pattern GGAC at the second position into the pattern GGTG. The disturbed alignment is depicted in (c).On the other hand, one may want to introduce the extra substitutions systematically and in a more convenient way. ImOSM provides a variety of settings to accomplish this. First, for each branch, different substitution classes may have different probabilities as described above. By providing equal probabilities for all the three substitution classes or for the two transversion classes, the more specialized models JC69 (Jukes and Cantor 1969) or K2P (Kimura 1980) are derived, respectively. Second, one can assign the number of extra substitutions per site to each branch by providing the branch lengths for the input tree. A branch is free from intermittent evolution by setting its length to zero. Last, the extra substitutions can be distributed to alignment sites according to a user-defined distribution.Accordingly, ImOSM introduces various model violation scenarios to the data: 1) Putting extra substitutions on a specific subset of branches violates the assumption of model homogeneity along the tree, 2) the probabilities of the three substitution classes of the K3ST model violate the underlying substitution rates along these branches, and 3) distributing extra substitutions to alignment sites under a different rate distribution violates the underlying RaS distribution. This implies heterotachy as the rate at a site shifts along branch(es) (Philippe and Lopez 2001).SimulationsWe study the robustness of three phylogenetic reconstruction methods ML, MP, and BIONJ against model violation yielded by ImOSM. Intermittent evolution is introduced to two nonsister external branches of a four-taxon tree and an eight-taxon balanced tree. The four-taxon tree allows for a unique choice of two nonadjacent external branches (ignoring the leaf labels); the eight-taxon tree allows for two possibilities (fig. 3). We call the trees C4, C8, and C8f, respectively. The internal branch lengths are set to 0.05 substitutions per site; whereas the external branch lengths (br) vary in {0.05,0.10,0.20,0.30,0.40,0.50,0.75,1.00}.Fig 3.Trees used in simulation and the corresponding abbreviations. Extra substitutions are introduced to the indicated external branches (refer to the text for further details).Seq-Gen (Rambaut and Grassly 1997) generates 100 alignments of length β„“β��{104,105} under the K2P + Ξ“ model, assuming a Ts/Tv ratio of 2.5 and a Ξ“-shape parameter Ξ± of 0.5 to model RaS heterogeneity. ImOSM then β€�disturbsβ€� each alignment by putting brie extra substitutions on the indicated external branches such that brie + 0.05 = br. Thus, the trees are β€�clock likeβ€� but two nonadjacent external branches evolve only partially according to the original K2P + Ξ“ model.Table 1 summarizes the different simulation settings. First, intermittent evolution retains Ts/Tv = 2.5 and the extra substitutions follow the site-specific rates as determined by Seq-Gen. Hence, the simulation does not introduce any model violation. We refer to this simulation setting as vNONE. Second, extra substitutions are selected uniformly from the substitution classes (JC69 model) but site-specific rates are not changed. Thus, ImOSM β€�violatesβ€� the Ts/Tv ratio on the indicated branches. We abbreviate this setting as vTsTv. Third, intermittent evolution retains Ts/Tv = 2.5 but now the extra substitutions are uniformly distributed. Therefore, ImOSM violates the RaS heterogeneity assumption on the indicated branches. This setting is referred to as vRaSV. Lastly, extra substitutions are selected uniformly from the substitution classes and distributed uniformly to alignment sites. Thus, both Ts/Tv and RaS heterogeneity are violated on the indicated branches. This setting is abbreviated as vBOTH.Table 1.Different Settings Illustrate Different Extent of Model Violation Introduced by ImOSM.AbbreviationModelImOSM SettingExtents of ViolationvNONEK2P + Ξ“aTs/Tv = 2.5 and RaSNo violationvTsTvK2P + Ξ“Ts/Tv = 1.0 and RaSTs/Tv violationvRaSVK2P + Ξ“Ts/Tv = 2.5 and no RaSRaS violationvBOTHK2P + Ξ“Ts/Tv = 1.0 and no RaSViolating both Ts/Tvβ€ƒβ€ƒβ€ƒβ€ƒand RaSaThe underlying model is K2P + Ξ“ with a Ts/TV ratio of 2.5 and a Ξ“-shape parameter Ξ± of 0.5 to model RaS heterogeneity.The disturbed alignments are subject to tree reconstruction. We use IQPNNI (Vinh and von Haeseler 2004, minh2005a) and PAUP* (Swofford 2002) to estimate the ML and MP trees, respectively. For the ML inference, we use K2P + Ξ“ and estimate the model parameters. NJ trees are computed with BIONJ (Gascuel 1997) using the ML distances based on the inferred model parameters from the ML tree estimation. This means that the ML and BIONJ inferences are conducted under a misspecified model for the vTsTv, vRaSV, and vBOTH settings. In addition, we perform Model-Test (Posada and Crandall 1998), test of model homogeneity across branches (Weiss and von Haeseler 2003) and goodness of fit tests (Goldman 1993, nguyen2011).
</sections.1>

<sections.2>
Results
ree econstruction ccuracy. Figure 4 presents the tree reconstruction accuracy for all simulation settings. The accuracy, that is, the proportion of alignments that yield the true tree, is shown on the y axis. The x axis displays the external branch length br or (brie + 0.05). The first two columns show the results for the four-taxon tree C4 with the sequence length of 104 and 105, respectively. The last two columns show the results for the eight-taxon tree C8. Results for C8f are similar to those for C8 and can be found in the supplementary figure S1, Supplementary Material online.Fig 4.Tree reconstruction accuracy, that is, the proportion of alignments that yield the true tree, is shown on the y axis for simulations with no model violation (vNONE, first row), with Ts/Tv violation (vTsTv, second row), with RaS violation (vRaSV, third row), and with both Ts/Tv and RaS violation (vBOTH, last row). The first two columns show the results for the four-taxon tree C4 with alignment length 104 and 105, respectively. The last two columns show the results for the eight-taxon tree C8. The x axis displays the external branch length br or (brie+0.05). Accuracy of ML is depicted by +, MP by ΠΎ, and BIONJ by Γ—.It should be noted that 100 replicates are sufficient for each (β„“,br) combination in agreement with Shavit Grievink et al. (2010), who also generated alignments of length 104. A further increase in the number of replicates does not change the results substantially (data not shown).No Model Violation and Ts/Tv ViolationThe first two rows of figure 4 show the accuracy for simulations with no model violation (vNONE) and with the violation of the transition/transversion ratio (vTsTv), respectively. For sequence length β„“ = 104, the accuracy of all three tree-building methods decreases as br increases for both scenarios (vNONE, vTsTv). ML performs best, whereas MP performs worst on the eight-taxon tree (C8). Nonetheless, as the sequence length increases to 105, all the methods successfully recover the true topology. Thus, the violation of the Ts/Tv ratio has almost no impact on the reconstruction accuracy; the accuracy is governed by the sequence length. This observation corroborates previous results (Fukami-Kobayashi and Tateno 1991, huelsenbeck1995).RaS ViolationThe third row of figure 4 displays the accuracy for simulations with the rates across sites heterogeneity violation (vRaSV). For the four-taxon tree C4 (the first two columns), the reconstruction accuracy, independent of the methods and independent of the alignment length, dramatically drops to 0 as br exceeds 0.4. Thus, the violation of RaS heterogeneity causes dramatic changes in the tree reconstruction accuracy.Surprisingly, for the eight-taxon tree C8 (fig. 4, third row, last two columns), BIONJ constantly performs best and recovers the true tree once the sequence length is large. ML performs slightly better than MP. However, they both suffer from the RaS heterogeneity violation: Their accuracy drops to 0 if br exceeds 0.4.It should be noted that we have checked and recorded no possible bias of BIONJ due to the input order of the sequences in the distance matrix. All runs with the β€�randomized input orderβ€� option in the NEIGHBOR program (the PHYLIP package, Felsenstein 1993) produced the same tree as the BIONJ tree. Moreover, the results do not change when PhyML (Guindon and Gascuel 2003) and DNAPARS (the PHYLIP package, Felsenstein 1993) are used to reconstruct the ML and MP trees, respectively.Both RaS and Ts/Tv ViolationThe last row of figure 4 shows the accuracy for simulations with the violation of both RaS heterogeneity and the Ts/Tv ratio (vBOTH). Similar to the vRaSV setting, this simultaneous violation yields not only a dramatic change in the accuracy but also distinct patterns for the C4 and C8 trees. For C4, the accuracy of all methods decreases independently of the sequence length as br increases. Interestingly, we observe a slow recovery of the accuracy for ML and BIONJ when br approaches 1.0; nonetheless, their accuracy never exceeds 23, even when we extend br to 2.0 (supplementary fig. S2, Supplementary Material online). The reason for the increase in the accuracy of ML and BIONJ as the external branch length exceeds 0.75 remains unclear. We note that Ho and Jermiin (2004) observed a similar behavior concerning ML.For C8, the accuracy of ML and MP suffers severely from the violation vBOTH, whereas BIONJ's accuracy is not affected for large sequence lengths.Parameter EstimationThe observed behavior of ML and BIONJ provokes a further investigation of the ML-estimated model parameters. Without any kind of model violation, vNONE, the ML estimations of both parameters, the Ts/Tv ratio and the Ξ“-shape Ξ± are very close to the corresponding true values (supplementary fig. S3, Supplementary Material online). This confirms the statistical consistency of ML inference for the model parameters if the sequence length is large enough.The transition/transversion ratio violation, vTsTv, has no influence on the estimation of Ξ±: the Inferred Ξ± is very close to the true value 0.5 (fig. 5, first row). However, the inferred Ts/Tv ratio substantially decreases from approximately 2.50 to 1.67 (C4) and to 2.07 (C8) as brie increases (fig. 5, second row). We note that the estimated Ts/Tv ratio roughly agrees with the branch length-weighted average of the two Ts/Tv ratios that were used in the simulations.Fig 5.ML parameter estimation in the presence of the transition/transversion ratio violation (vTsTv). The first and the last rows show the estimation of the Ξ“-shape parameter Ξ± and the Ts/Tv ratio, respectively. Results for the four-taxon tree C4 are presented on the left and for the C8 tree on the right. The x axis displays the external branch length br or (brie + 0.05).Notably, the rates across sites heterogeneity violation, vRaSV, influences not only the estimation of Ξ± but also the Ts/Tv inference (fig. 6, first and last row, respectively). The estimated Ξ± for the C4 and C8 trees are both larger than 0.5 reflecting lower RaS heterogeneity induced by ImOSM. A substantially larger Ξ± is inferred for C4 than for C8. For the C4 tree, the inferred Ξ± grows almost linearly with increasing external branch lengths, whereas the estimated Ξ± for C8 increases to a maximum of 1.11 and subsequently decreases. Similarly, the inferred Ts/Tv deviates from 2.5 more dramatically for C4 than for C8. Note that the proportion of extra substitutions with respect to the total tree length (sum of all branch length plus extra substitutions) is larger on the four-taxon tree (2(brβ�’0.05)4br+0.05) than on the eight-taxon tree (2(brβ�’0.05)8br+0.25). This leads to the above differences and results in the distinct patterns of behavior (in terms of reconstruction accuracy) of BIONJ between the C4 and C8 trees.Fig 6.ML parameter estimation in the presence of rates across sites violation (vRaSV). The first and the last rows show the estimation of the Ξ“-shape parameter Ξ± and the Ts/Tv ratio, respectively. Results for the four-taxon tree C4 are presented on the left and for the C8 tree on the right. The x axis displays the external branch length br or (brie + 0.05).Finally, the estimation of Ξ± and Ts/Tv under the violation of both RaS and Ts/Tv (vBOTH) shows similar patterns to those under vRaSV (supplementary fig. S4, Supplementary Material online). The parameters estimated for the C8f tree are similar to those for C8 as summarized in the supplementary figure S5, Supplementary Material online.Possible Topological Bias under vRaSV SettingWe further check for possible topological biases, that is, consistently inferring a β€�wrongβ€� topology, under the vRaSV setting. For the four-taxon tree C4, as the sequence length increases to 105 and br exceeds 0.4, all three methods always infer the wrong topology (A,C,(B,D)), which groups taxa that evolve similarly, that is, (A,C) and (B,D). We noted that a unique MP tree is reconstructed for each of the alignments. Remarkably, although evolution was clock like, all methods infer substantially larger branch lengths for the external branches leading to A and to C than for the other external branch lengths. Moreover, the estimated internal branch length is significantly larger than zero (the average internal branch length inferred by each of the three methods is larger than 0.03, table 2). This means that we did not observe a polytomy concerning the inferred tree.Table 2.Trees and Branch Lengths Inferred by ML, MP, and BIONJ for the Four-Taxon Tree (C4) with External Branch Length br = 0.5 Under the vRaSV Setting for Sequence Length
l β‰¥ 105For the eight-taxon trees BIONJ always infers, independently of the external branch lengths, one tree (the true tree) as β„“ grows to 105. In contrast, as br exceeds 0.4 neither ML nor MP converge to a single tree. Therefore, we increased β„“ up to 107. Table 3 shows the number of tree topologies reconstructed by ML and MP for the C8 and C8f trees with br = 0.5. As β„“ increases to 107, the ML inference converges to a single tree, whereas MP reconstructs more than one tree.Table 3.Number of Tree Topologies Inferred by ML (First Block) and MP (Second Block) for the C8 and C8f Trees with External Branch br = 0.5 Under the vRaSV Setting for Sequence Length
l β�� {105, 106, 107}MethodTreeSequence Length l105106107MLC8211C8f941MPC8222C8f432Table 4 shows the tree topologies and their frequencies inferred by ML (first block) and MP (second block) for the C8 tree (left) and C8f (right) with ). For both the C8 and C8f trees, ML constantly recovers the innermost branch. On each side of the innermost branch, ML then groups taxa that evolve under the pure K2P + Ξ“ model. For C8, the subtree ((E,F),(G,H)) is accurately reconstructed; however, taxa B and D are always incorrectly clustered in the other subtree. In addition, ML cannot resolve the positions of taxa A and C, thus yielding a multifurcating node in the tree. For C8f, the two cherries (C,D) and (G,H), each in one subtree of the innermost branch, are correctly inferred. However, in 67%, the cherry (C,D) is wrongly grouped with taxon B in one subtree and the cherry (G,H) is erroneously clustered with taxon F in the other subtree. The remaining 33 trees are multifurcating. Nonetheless, as β„“ grows to 107, the ML reconstruction converges to the first (the highlighted) tree. Hence, ML fails to recover the true tree for both the C8 and C8f trees.Table 4.Tree Topologies Inferred by ML (First Block) and MP (Second Block) for the C8 (Left) and C8f (Right) Trees with External Branch br = 0.5 Under the vRaSV Setting for Sequence Length l β‰¥ 106Note.β€”Recall that ImOSM introduced extra substitutions to the indicated external branches.MP also fails to reconstruct the true tree for both the C8 and C8f trees but shows a different behavior from ML. For C8, MP infers two tree topologies for β„“ = 106 (table 4, second block, left column). In both topologies, the two taxa A and C, which are affected by intermittent evolution, erroneously form a cherry. For C8f, three topologies are reconstructed and they all group taxa A and E (table 4, second block, right column); therefore, MP cannot recover the internal branch separating {A,B,C,D} from {E,F,G,H}.Thus, MP does not converge to a single tree (even if β„“ = 107) and always clusters taxa evolving with lower RaS heterogeneity (induced by ImOSM) regardless of their positions in the tree (refer to the C8 and C8f trees) and regardless of the tree size (four- and eight-taxon trees). In contrast, ML infers a single wrong tree and tends to group β€�relatively closeβ€� taxa (on the same side of the innermost branch of the eight-taxon trees) evolving with larger RaS heterogeneity, that is, taxa evolving under the pure K2P + Ξ“ model. Finally, we note that the behavior of each of the methods under the vBOTH setting is similar to its behavior under the vRaSV setting.Model Test and Goodness of Fit Evaluation under vRaSV SettingWe perform several tests to complete the ML analysis for β„“ = 105 under the vRaSV setting. The Bayesian information criterion, BIC, (Schwarz 1978) selects K2P + Ξ“ for more than 99% of the alignments (Table S1 a). This means BIC does not identify local deviation from the original model. Markedly, the test proposed by Weiss and von Haeseler (2003) rejects the assumption of model homogeneity across branches (significance level Ξ± = 0.05) for almost all alignments (more than 99% on average) if brie > 0 (Table S1 b).We further investigate the goodness of fit of the K2P + Ξ“ model and the inferred ML tree to the data using the Cox test (Goldman 1993) and MISFITS (Nguyen et al. 2011). For each of the 100 disturbed alignments, we performed parametric bootstrap with 100 replicates. The Cox test rejects, independently of the tree size, the K2P + Ξ“ model for all alignments if brie > 0 (Table S1 c). MISFITS rejects the K2P + Ξ“ model and the inferred tree for a smaller proportion of alignments from the four-taxon tree (an average of 46% for brie > 0) than from the eight-taxon trees (90%, Table S1 d).
</sections.2>

<sections.3>
Discussion
e introduced m. OSM, a tool to imbed intermittent evolution into phylogenetic data in a systematic manner. The intermittent evolution processes allow for an arbitrary number of distinct sets of relative substitution rates between specific nucleotides (as reflected by the probabilities of the three substitution classes in the K3ST model) along different branches. Moreover, the distribution of RaS can be different across branches. Thereby, ImOSM provides a convenient means to simulate heterogeneous relative substitution rates across branches (e.g., the vTsTv setting) and heterotachy (e.g., the vRaSV setting). For studies of robustness in phylogenetic inference, ImOSM complements currently available sequence simulation programs by providing a flexible utility to incorporate various types of model violations into the simulated alignments. We note that several studies of postmortem sequence damage in ancient DNA also employed the concept of extra mutations (e.g., Ho et al. 2007, Mateiu and Rannala 2008, Rambaut et al. 2009). Additional mutations were introduced to external branches of the tree to mimic the presence of damaged nucleotides in extant sequences. The β€�disturbedβ€� data were then used to study the estimation of the amount of nucleotide damage.
We investigated the robustness of ML and BIONJ under a misspecified model as well as MP to model violations introduced to four- and eight-taxon clock-like trees. We showed that the accuracy of all methods was unaffected by the violation of the Ts/Tv ratio on two nonadjacent external branches. The RaS heterogeneity violation hampered all methods recovery of the true topology for the four-taxon tree as the external branch length increased. For the eight-taxon balanced trees, the violation of RaS heterogeneity and the simultaneous violation of RaS and the Ts/Tv ratio on two nonsister external branches caused each of the three methods to infer a different topology. BIONJ using the ML-estimated distances always returned the correct tree; MP incorrectly grouped the two branches undergoing intermittent evolution (i.e., with lower RaS heterogeneity), whereas ML tended to cluster close taxa evolving with higher RaS heterogeneity. In addition, if the affected branches are close, that is, on the same side of the innermost branch in the C8 tree, ML inferred a multifurcating tree.
Previously, Kolaczkowski and Thornton (2004) reported that MP outperforms misspecified ML inference and is resistant to a specific setting of heterotachy, in which concatenated data are generated from the same four-taxon tree but with different branch length sets. Their result stimulated numerous discussions about the performance of MP and ML tree estimation in the presence of heterotachy. Contradictions to this result were demonstrated for many other combinations of branch lengths (see e.g., Gadagkar and Kumar 2005, gaucher2005, philippe2005, spencer2005, lockhart2006). More recently, Wu and Susko (2009) proposed a pairwise alpha heterotachy adjusted (PAHA) distance approach such that NJ with PAHA distances outperformed ML in several settings of heterotachy including the one from Kolaczkowski and Thornton (2004). Here, we reported cases in which all methods (ML, MP, and BIONJ) incorrectly grouped two nonadjacent branches affected by RaS violation for the four-taxon clock-like tree if the external branch length exceeds 0.4. Moreover, they all estimated larger branch lengths for these two branches. This implies that quartet-based analyses, where different methods reconstruct the same tree with long-branch attraction, should be interpreted with caution for real data.
The superiority of BIONJ over ML and MP for the eight-taxon trees is surprising. ML was reported in previous studies (e.g., Hasegawa et al. 1991, Huelsenbeck 1995b) to be more robust to model violation than distance methods such as NJ; nonetheless, the simulation settings (one evolutionary model) and model trees (four-taxon trees) used in these studies were different from our simulations. Unfortunately, as the three methods infer three different topologies (see also supplementary fig. S6, Supplementary Material online), the joint analysis of such alignments by different tree reconstruction methods does not provide any indication of which tree may be the correct one. Thus, a more detailed analysis of the data is advised. Model-Test (Posada and Crandall 1998), which selects a model from a collection of available models but makes no statement about the goodness of fit, did not help in these cases. BIC constantly selected K2P + Ξ“ as the best model for the disturbed alignments. Fortunately, the test proposed by Weiss and von Haeseler (2003) rejected the assumption of a homogeneous substitution process along the tree. This indicates that the data show model violation. Subsequently, the Cox test (Goldman 1993) and MISFITS (Nguyen et al. 2011) demonstrated that the violation is so severe that the selected model and the inferred tree cannot explain the data adequately; hence, one should be careful in interpreting the tree. Therefore, we recommend using tests of model homogeneity when applicable and using tests of model fit in every practical phylogenetic analysis. If the tests reject the model, then any biological conclusion from the inferred trees should be handled with care.
Finally, we note that our simulations imply a kind of heterotachy. Thus, an interesting extension of this work would be to evaluate the accuracy of branch length mixture models that aim to account for heterotachy (Kolaczkowski and Thornton 2008, pagel2008). We also note that the aim of the paper was not an exhaustive simulation study for different model violations. We rather provide a tool to introduce model violations and show that already very simple violations of the model on two branches of the tree can lead to bewildering results, like the three different trees inferred by the three different phylogenetic reconstruction methods.
</sections.3>

<sections.4>
Supplementary aterial
upplementary figures 1β€“6 are available at olecular iology and volution online (http://www.mbe.oxfordjournals.org/).Supplementary Material
Supplementary figures S1β€“S6 are available at Molecular Biology and Evolution online (http://www.mbe.oxfordjournals.org/).
</sections.4>

<sections.5>
Program vailability
 ++ implementation for m. OSM is freely available at http://www.cibiv.at/software/imosm.
</sections.5>

<sections.6>
Supplementary aterial


upplementary ataSupplementary Material


Supplementary Data
</sections.6>

</text>
